name: "test_anemll_generation"
listeners:
  - Macmon
pipelines:
  - name: Anemll Generation Test
    inputs: [0]
    outputs: [1]
    dataset_stage_id: 0
    loadgen:
      component: loadgen.OfflineLoadScheduler
      queue_depth: 5
      max_queries: 10 # minimal for testing ANE speed
      timeout: 60000
      config:
        rate: 1 
    stages:
      - name: Mock dataloader
        id: 0
        outputs: [1]
        component: stages.llm_huggingface.MockDataLoader  
        config:
          tokenizer_stage_id: 1
          batch_size: 1
          shuffle: True
          split: ["train"]
          dataset:
            name: yahma/alpaca-cleaned
            system_column_name: instruction
            user_column_name: input
            assistant_column_name: output
      - name: Anemll Infer
        id: 1
        component: stages.anemll.Inference
        config: 
          model:
            name: stages/anemll/models/anemll-Qwen3-4B-ctx1024_0.3.0
            max_new_tokens: 100
            gen_kwargs: {}
